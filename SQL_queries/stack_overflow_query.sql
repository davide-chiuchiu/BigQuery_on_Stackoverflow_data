-- ADD SQL COMMENTS TO MAKE THE CODE MORE CLEAR-- LIMIT the subquery to speed up exection and keep within limit for GCP-- CTE with small amount of questions to processWITH questions_subset AS (    SELECT *     FROM posts_questions    ORDER BY id    LIMIT 50000),-- CTE with a wery small amount of answers to processanswers_subset AS (    SELECT *    FROM posts_answers    ORDER BY parent_id    LIMIT 50000),    -- CTE with the date of the first answer to each questionfirst_answer_dates AS (    SELECT parent_id,       MIN(creation_date) AS date_of_first_answer    FROM answers_subset    GROUP BY parent_id    ORDER BY parent_id),-- CTE with the creation date, date of first answer, date of accepted answer,-- hours to get the first and the accepted answers, and tags for each question.time_information_for_questions_and_answers AS(    SELECT         questions_subset.id,        questions_subset.creation_date,        first_answer_dates.date_of_first_answer,        -- calculate hours to get th first answer        TIMESTAMP_DIFF(first_answer_dates.date_of_first_answer, questions_subset.creation_date, HOUR) AS hours_before_first_answer,        answers_subset.creation_date AS date_of_accepted_answer,        -- calculate hours to get th accepted answer        TIMESTAMP_DIFF(answers_subset.creation_date, questions_subset.creation_date, HOUR) AS hours_before_accepted_answer,        questions_subset.tags    FROM questions_subset    -- add the timestampof the first answer to the question    INNER JOIN first_answer_dates        ON questions_subset.id = first_answer_dates.parent_id    -- add the timestamp of the accepted answer to the question    INNER JOIN answers_subset        ON questions_subset.accepted_answer_id = answers_subset.id),-- CTE with the creation date, the hours before the first answer, the hours of -- delay between the first and accepted answer, and the tags for each question.-- Tags re processed so that each row has a unique tagtime_info_and_tags_summary AS(    SELECT        id,        creation_date,        hours_before_first_answer,        hours_before_accepted_answer - hours_before_first_answer AS first_accepted_delay,        unique_tag    FROM time_information_for_questions_and_answers    CROSS JOIN UNNEST(SPLIT(tags, '|')) AS unique_tag)-- Query to extract the histogram of waiting times for answers for each tagSELECT     unique_tag,    hours_before_first_answer,    COUNT(DISTINCT id) AS count_of_questionsFROM time_info_and_tags_summaryGROUP BY unique_tag, hours_before_first_answerORDER BY unique_tag, hours_before_first_answer;